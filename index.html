<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FourTwenty Analytics â€” Portfolio Hub</title>
  <meta name="description" content="FourTwenty Analytics portfolio hub. Left panel renders README.md from the repo root." />
  <meta name="color-scheme" content="light dark" />

  <!-- Favicon (optional) -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ðŸŒ¿</text></svg>">

  <!-- GitHub Markdown styles (for nicer README rendering) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.5.1/github-markdown.min.css" integrity="sha512-5gCgV7rLyGuB1QKco67qXlUc9cWn2s/IOp3rCUTZHd5AxW1HjWj0o4s8g4CzQ5o2p8m0vgr2Q2kq9Tn0j0Qomw==" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- highlight.js (syntax highlighting for code blocks) -->
  <link rel="stylesheet" href="https://unpkg.com/highlight.js/styles/github.min.css">

  <style>
    :root {
      --bg: #0b0c0f;
      --card: #12141a;
      --muted: #98a2b3;
      --text: #e5e7eb;
      --border: #1f2230;
      --accent: #22c55e;
    }
    html, body { height: 100%; }
    body { margin: 0; font: 14px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji"; color: var(--text); background: linear-gradient(180deg, #0b0c0f, #0e1116); }
    a { color: #93c5fd; }

    /* Layout */
    .wrap { display: grid; grid-template-rows: auto 1fr; height: 100vh; }
    header { border-bottom: 1px solid var(--border); backdrop-filter: saturate(120%) blur(4px); background: rgba(13, 16, 22, 0.7); }
    .bar { display: flex; align-items: center; justify-content: space-between; gap: 12px; padding: 14px 18px; }
    .brand { display: flex; align-items: center; gap: 10px; font-weight: 600; letter-spacing: .2px; }
    .brand .dot { font-size: 18px; }
    .brand .name { font-size: 15px; opacity: .9; }

    main { display: grid; grid-template-columns: 1fr 320px; gap: 16px; padding: 16px; }
    @media (max-width: 960px) { main { grid-template-columns: 1fr; } }

    .panel { border: 1px solid var(--border); background: linear-gradient(180deg, #10131a, #0f1218); border-radius: 12px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,.25); }
    .panel .head { display:flex; align-items:center; justify-content:space-between; padding: 10px 14px; border-bottom: 1px solid var(--border); background: rgba(15, 18, 25, .6); }
    .panel .head h3 { margin: 0; font-size: 13px; letter-spacing: .4px; text-transform: uppercase; color: var(--muted); }
    .panel .body { padding: 0; }

    /* README panel specifics */
    #readme-panel { padding: 18px; max-height: calc(100vh - 140px); overflow: auto; }
    .markdown-body { color: var(--text); background: transparent; }
    .markdown-body h1, .markdown-body h2, .markdown-body h3, .markdown-body h4 { border-bottom: none; }

    /* Right panel content placeholder (keep your existing content here) */
    #right-panel { padding: 12px; }

    footer { border-top: 1px solid var(--border); padding: 10px 16px; font-size: 12px; color: var(--muted); }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Top Bar (keep your existing content; tweak as needed) -->
    <header>
      <div class="bar">
        <div class="brand">
          <div class="dot">ðŸŒ¿</div>
          <div class="name">FourTwenty Analytics â€” Portfolio Hub</div>
        </div>
        <nav style="display:flex; gap:10px; font-size:13px;">
          <a href="https://github.com/zbreeden/FourTwentyAnalytics" target="_blank" rel="noopener">GitHub</a>
          <a href="https://zbreeden.github.io/FourTwentyAnalytics/" aria-current="page">Home</a>
        </nav>
      </div>
    </header>

    <main>
      <!-- LEFT: README renderer -->
      <section class="panel">
        <div class="head">
          <h3>README.md (repo root)</h3>
        </div>
        <div class="body">
          <article id="readme-panel" class="markdown-body"></article>
        </div>
      </section>

      <!-- RIGHT: keep your existing right-panel content (cards, links, etc.) -->
      <aside class="panel">
        <div class="head">
          <h3>Side Panel</h3>
        </div>
        <div class="body" id="right-panel">
          <!-- Replace this placeholder with your current right-panel markup. -->
          <div style="padding:14px; color:var(--muted)">Your existing right-panel content lives here.</div>
        </div>
      </aside>
    </main>

    <footer>
      <div>Â© FourTwenty Analytics â€” README panel auto-renders from <code>main/README.md</code>.</div>
    </footer>
  </div>

  <!-- Marked (Markdown â†’ HTML) -->
  <script src="https://unpkg.com/marked/marked.min.js"></script>
  <!-- highlight.js (syntax highlighting) -->
  <script src="https://unpkg.com/highlight.js/lib/common.min.js"></script>

  <script>
  (function() {
    // Configure your repo here
    const GITHUB_USER = "zbreeden";
    const REPO        = "FourTwentyAnalytics";
    const BRANCH      = "main"; // change if your default branch differs

    const RAW_README  = `https://raw.githubusercontent.com/${GITHUB_USER}/${REPO}/${BRANCH}/README.md`;
    const BASE_RAW    = `https://raw.githubusercontent.com/${GITHUB_USER}/${REPO}/${BRANCH}/`;
    const BASE_REPO   = `https://github.com/${GITHUB_USER}/${REPO}/blob/${BRANCH}/`;

    const panel = document.getElementById("readme-panel");
    if (!panel) return;

    fetch(RAW_README, { cache: "no-store" })
      .then(r => { if (!r.ok) throw new Error(`Fetch failed (${r.status})`); return r.text(); })
      .then(md => {
        const html = marked.parse(md, { mangle: false, headerIds: true });
        panel.innerHTML = html;

        // Rewrite relative images to RAW URLs
        panel.querySelectorAll("img").forEach(img => {
          const src = img.getAttribute("src") || "";
          if (src && !/^(https?:)?\/\//i.test(src) && !src.startsWith("data:")) {
            img.src = new URL(src, BASE_RAW).href;
          }
        });

        // Rewrite relative links to repository blob URLs
        panel.querySelectorAll("a").forEach(a => {
          const href = a.getAttribute("href") || "";
          if (!href) return;
          if (href.startsWith("#")) return; // anchors are fine
          if (/^(https?:)?\/\//i.test(href) || href.startsWith("mailto:")) return; // absolute links
          a.href = new URL(href, BASE_REPO).href;
          a.target = "_blank"; a.rel = "noopener";
        });

        // Syntax highlighting
        panel.querySelectorAll("pre code").forEach(block => { try { hljs.highlightElement(block); } catch(e) {} });
      })
      .catch(err => {
        panel.innerHTML = `
          <div style="padding:12px; border:1px solid var(--border); border-radius:10px;">
            <strong>Couldnâ€™t load README.md</strong><br/>
            <code>${err.message}</code><br/>
            <a href="${BASE_REPO}README.md" target="_blank" rel="noopener">Open README on GitHub</a>
          </div>`;
      });
  })();
  </script>

  <!-- Optional: Google Tag Manager (replace with your container ID) -->
  <!--
  <script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
    var f=d.getElementsByTagName(s)[0], j=d.createElement(s), dl=l!='dataLayer'?'&l='+l:'';
    j.async=true; j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl; f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-XXXXXXX');
  </script>
  -->
</body>
</html>
